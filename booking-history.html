<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booking History</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="container">
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="trainsearch.html">Train Search</a></li>
                <li><a href="booking-history.html">Booking History</a></li>
            </ul>
        </nav>
        <h1>Booking History</h1>

        <div>
            <label for="trainName">Train Name:</label>
            <input type="text" id="trainName" placeholder="Filter by train name">

            <label for="bookingStatus">Booking Status:</label>
            <select id="bookingStatus">
                <option value="">All</option>
                <option value="Confirmed">Confirmed</option>
                <option value="Cancelled">Cancelled</option>
            </select>

            <label for="travelDate">Date:</label>
            <input type="date" id="travelDate">

            <button onclick="filterBookings()">Search</button>
            <button onclick="resetFilters()">Reset</button>
        </div>

        <div id="bookingList"></div>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            displayBookings(); // Show all bookings on load
        });

        function displayBookings(bookings = []) {
            if (bookings.length === 0) {
                bookings = JSON.parse(localStorage.getItem("bookings")) || [];
            }

            const bookingList = document.getElementById("bookingList");
            bookingList.innerHTML = bookings.map(booking => `
                <div class="booking">
                    <p>Name: ${booking.name}</p>
                    <p>Train: ${booking.trainName}</p>
                    <p>Source: ${booking.source}</p>
                    <p>Destination: ${booking.destination}</p>
                    <p>Date: ${booking.date}</p>
                    <p>Seat Class: ${booking.seatClass}</p>
                    <p>Status: ${booking.status}</p>
                </div>
            `).join('');
        }

        function filterBookings() {
            const trainName = document.getElementById("trainName").value.toLowerCase();
            const bookingStatus = document.getElementById("bookingStatus").value;
            const travelDate = document.getElementById("travelDate").value;

            const bookings = JSON.parse(localStorage.getItem("bookings")) || [];
            const filteredBookings = bookings.filter(booking => {
                const matchesTrain = trainName ? booking.trainName.toLowerCase().includes(trainName) : true;
                const matchesStatus = bookingStatus ? booking.status === bookingStatus : true;
                const matchesDate = travelDate ? booking.date === travelDate : true;

                return matchesTrain && matchesStatus && matchesDate;
            });

            displayBookings(filteredBookings);
        }

        function resetFilters() {
            document.getElementById("trainName").value = '';
            document.getElementById("bookingStatus").value = '';
            document.getElementById("travelDate").value = '';
            displayBookings(); // Display all bookings again
        }
    </script>
</body>

</html>